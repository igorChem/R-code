{
    "contents" : "## modelos mistura para reunião do dia 22\n\n\n#modelo para viscosidade\nattach(viscosity)\nbad <- (viscosidade.MPa.s. >10)\n\nvi <-subset(viscosidade.MPa.s., bad==\"FALSE\")\nxil <-subset(xIL,bad==\"FALSE\")\nxmdea <-subset(xMDEA,bad==\"FALSE\")\nTemperatura1 <-subset(Temperatura,bad==\"FALSE\")\nxyplot(xil~(vi)|Temperatura,data = viscosity,auto.key = T)\nplot(vi~xil)\nplot(log(vi)~Temperatura1)\npls1 <-mvr(log(vi)~Temperatura1+(xil^2)+xmdea,3,validation = \"CV\",method = \"oscorespls\")\nsummary(pls1)\nR2(pls1)\nvidata <-subset(viscosity,Temperatura==\"303.15\")\npls2 <-mvr(viscosidade.MPa.s.~xIL+xMDEA+xWater+(xIL*xMDEA),3,validation = \"CV\",method = \"oscorespls\")\nsummary(pls2)\nprcomp(vidata)\nxyplot(molaril+molar.mdea~log(viscosidade.MPa.s.)|Temperatura,type=\"smooth\",auto.key = T)\nxyplot(molaril+molar.mdea~viscosidade.MPa.s.|Temperatura,type=\"smooth\",auto.key = T)\n\nxyplot(fractionil+fra....omdea~viscosidade.MPa.s.|Temperatura,type=\"p\",auto.key = T)\nplsvi <-mvr(log(viscosidade.MPa.s.)~molar.mdea+Temperatura+(molaril*molar.mdea)+molaril,4,validation = \"CV\",method = \"oscorespls\")\nsummary(plsvi)\nmR2(plsvi)\nloadings(plsvi)\ncoefficients(plsvi,intercept = T)\npredict(plsvi,newdata = predictviscosity)\n\n#função para quatro componetes do plsvi\n# log(visidade)= 4.982748145+0.041460947[MDEA]-0.014104034[Temperatura]+0.080312472[molaril]-0.006223695([MDEA]*[IL])\n\nplsvi2 <-mvr(viscosidade.MPa.s.~fractionil+fra....omdea+Temperatura,3,validation = \"CV\",method = \"oscorespls\")\nsummary(plsvi2)\nR2(plsvi2)\n\n\n#exemplo \ng <- expand.grid(x = 1:10, y = 5:15, gr = 1:2)\ng$z <- log((g$x^g$gr + g$y^2) * g$gr)\nwireframe(z ~ x * y, data = g, groups = gr,\n          scales = list(arrows = FALSE),\n          drape = TRUE, colorkey = TRUE,\n          screen = list(z = 30, x = -60))\n#plots viscosidade\nfr <-expand.grid(molaril=0.1:5,molar.mdea=0.1:5,Temperatura=303.15)\nfr$z <- predict(plsvi,newdata = fr)\nwireframe(z~molaril*molar.mdea,data=fr, scales = list(arrows = FALSE),colorkey=T,screen = list(z = 30, x = -60),drape=T)\n\nattach(sorption)\nattach(visc)\nvisc <-data.frame(x1,x2,x3,y,Temperatura)\nx1 <-xIL\nx2 <-xMDEA\nx3 <-xH2O\ny <-viscosidade\nmixvars<-c(\"x1\",\"x2\",\"x3\")\nmodVI <-MixModel(visc,\"y\",mixcomps = c(\"x1\",\"x2\",\"x3\"),5,procvars = \"Temperatura\")\nmodVII <-MixModel(visc,\"y\",mixcomps = c(\"x1\",\"x2\",\"x3\"),4)\nMixturePlot(x=x1,y=x2,z=x3,w=y,des=visc,mod=4,despts = F,cols=T)\n\nModelPlot(modVI,dimensions= list(x1=\"x1\",x2=\"x2\",x3=\"x3\"),\n          lims=c(0,.4,0,.2,.4,1),constraints=F,contour=TRUE,\n          cuts=6,fill=TRUE,axislabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"),\n          colorkey = T,color.palette = terrain.colors,main=\"Viscosidade\",\n          cornerlabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"), slice = list(process.vars=c(Temp=303.15)))\n\n#plots 3d with persp function for viscosity\nxMDEA2 <-seq(0,5,length=30)\nxIL2 <-seq(0,5,length=30)\nxH2O2 <-seq(0.4,1,length=30)\nTemperature <-seq(303.15,353.15,length=30)\nf4 <-function(xMDEA2,xIL2) {exp(4.982748145+0.080312472*xIL2+0.041460947*xMDEA2-0.006223695*xMDEA2*xIL2-0.014104034*Temperature)}\nf8 <-function(Temperature,xIL2) {exp(4.982748145+0.080312472*xIL2+0.041460947*xMDEA2-0.006223695*xMDEA2*xIL2-0.014104034*Temperature)}\nz <-outer(Temperature,xIL2,f8)\n\n\npersp(Temperature,xIL2,z,phi = 20,theta = 70,shade=T,col=color[facetcol],\n      main = \"Viscosidade (MPa.s)\", xlab = \"Temperature\",ylab = \"xBMIMBF4\",zlab = \"MPa.s\",\n      ticktype = \"detailed\",ltheta = 55,lphi=40)\n#\nModelPlot(plsvi)\n\n#modelo para misturas binárias entre água e MDEA \n#plots \ndetach(viscosity)\nattach(sorption)\nabi <-subset(sorption,binary==\"yes\")\nxyplot(xIL~Fraction|Temperatura,data = abi)\n\n#pls\n# curva de resposta\n\n#modelo para mistura binário entre água e [BMIM][Cl]\n#plots\n#pls\n#curva de resposta\n\n#modelo de mistura ternária para absroção \n#plots\n#modelmix\n#plot mix \nabi2 <-subset(sorption,mix==\"yes\")\nxyplot(xMDEA~Fraction,data=abi2,auto.key = T)\nxyplot(xIL~Fraction,data=abi2,auto.key = T)\n\n\n#\nad <-terrain.colors(10)\nmod1 <-MixModel(abi2,\"Fraction\",mixcomps = c(\"xIL\",\"xMDEA\",\"xH2O\"),model=2)\nmod11 <-MixModel(abi2,\"Fraction\",mixcomps = c(\"xIL\",\"xMDEA\",\"xH2O\"),model=4)\nmod22 <-MixModel(abi2,\"Fraction\",mixcomps = c(\"xIL\",\"xMDEA\",\"xH2O\"),model=5,procvars = \"Temperatura\")\n\nModelPlot(mod11,dimensions =list(x1=\"xIL\",x2=\"xMDEA\",x3=\"xH2O\"),\n          lims=c(0,.4,0,.2,.4,1),constraints=F,contour=TRUE,cuts=12,fill=TRUE,axislabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"),colorkey = T,color.palette = terrain.colors,main=\"Molar Fraction\",cornerlabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"))\n\n\npdetach(sorption)\n\n.xMDEA <-seq(0,0.2,length=20)\n.IL <-seq(0,0.4,length=20)\n.H2O <-seq(0.4,1,length=20)\n#\nyu <-heat.colors(range(z))\n\n\n\n#xCO_2=0.2079*[BMIM][BF4]+0.4522*MDEA+0.0540*xH_2 O+0.165*x[BMIM][BF4]*xMDEA-0.1*x[BMIM][BF4]*xH_2 O-0.3*xMDEA*xH_2 O\nf <-function (.IL,.xMDEA) {0.2079*.IL+0.455*.xMDEA+0.0540*.H2O+0.165*.IL*.xMDEA-0.1*.IL*.H2O-0.3*.xMDEA*.H2O} \nf2 <-function(.IL,.H2O) {0.2079*.IL+0.455*.xMDEA+0.0540*.H2O+0.165*.IL*.xMDEA-0.1*.IL*.H2O-0.3*.xMDEA*.H2O}\nz <-outer(.IL,.H2O,f)\nz <-outer(.IL,.H2O,f2)\n\n\nf3 <-function(.xMDEA,.IL) {0.2079*.IL+0.455*.xMDEA+0.0540*.H2O+0.165*.IL*.xMDEA-0.1*.IL*.H2O-0.3*.xMDEA*.H2O}\nz <-outer(.xMDEA,.H2O,f3)\nf5 <-function(.xMDEA,.H2O) {0.2079*.IL+0.455*.xMDEA+0.0540*.H2O+0.165*.IL*.xMDEA}\nz <-outer(.xMDEA,.IL,f5)\npersp(.IL,.xMDEA,z,phi = 30,theta = 40,shade=T,col=color[facetcol],\n      main = \"xCO2\", ylab = \"xMDEA\",xlab = \"xBMIMBF4\",zlab = \"xCO2\",\n      ticktype = \"detailed\",ltheta = -30)\n\nsd <-as.matrix(z)\n\n##programação de cores da superfície\njet.colors <- colorRampPalette( c(\"purple\",\"blue\", \"green\",\"yellow\",\"orange\",\"red\") )\nnbcol <- 1000\ncolor <- jet.colors(nbcol)\nnrz <- nrow(z)\nncz <- ncol(z)\nzfacet <- z[-1, -1] + z[-1, -ncz] + z[-nrz, -1] + z[-nrz, -ncz]\nfacetcol <- cut(zfacet, nbcol)\n\nattach(descr)\nx1 <-xIL\nx2 <-xMDEA\nx3 <-xH2O\nw <-y\ne1 <-data.frame(x1,x2,x3,y)\nMixturePlot(x=x1,y=x2,z=x3,w=y,des=e1,color.palette = terrain.colors, cols = T,mod=2,lims = c(0,0.4,0,0.2,0.4,1),colorkey = T,constrts = T)\n#modelo de mistura ternário para densidade \n#modelmix \n#plotmix\nmod2 <-MixModel(abi2,\"Densidade.l..quido.\",mixcomps = c(\"xIL\",\"xMDEA\",\"xH2O\"),model=1)\nModelPlot(mod2, dimensions = list(x1=\"xIL\",x2=\"xMDEA\",x3=\"xH2O\"),constraints=F,contour=TRUE,cuts=10,fill=TRUE,axislabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"),colorkey = T,color.palette = terrain.colors,main=\"Densidade\",cornerlabs = c(\"x[BMIM][BF4]\",\"xMDEA\",\"xH2O\"))\n#modelo de mistura para preço \n#model mix \n#modelplot\n\n#plot viscosidade \n\ndetach(descr)\nxyplot(Densidade.l..quido.+(viscosidade)~Fraction,outer=T,type=\"smooth\")\nf <-lm(log(Fraction)~log(1/viscosidade))\nsummary(",
    "created" : 1445209522381.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "92202176",
    "id" : "89355FCD",
    "lastKnownWriteTime" : 1445812689,
    "path" : "~/r/MixLIMDEA/modelomixture.R",
    "project_path" : "modelomixture.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}