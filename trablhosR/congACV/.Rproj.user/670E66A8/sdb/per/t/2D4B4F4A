{
    "contents" : "# Análises estatística sobre a produção de soja no brasil. \n\n# 1.Carregar os packges. \nlibrary(lattice)\nlibrary(pls)\nlibrary(gtools)\n\n# função para o coeficiente de variação. \nCV <- function(mean, sd){\n  (sd/mean)*100\n}\n\n# 2. Anexar os dados\nattach(soja)\nnames(soja)\nsummary(soja)\n\n# 3. subsetting to create only non-NA matrix \nmat1 <-subset(soja,!kg_CO2_Eq==\"NA\") \nmat2 <-subset(soja,!N==\"NA\")\nmat01<-mat1[,-4]\n\n# 4. analise exploratória \n#4.1\ncov(soja[,3:11])\ncor(soja[,3:11])\n\n# 4.2 plots de variaveis contra grupos regional-nacional \n\nplot(Produtividade~Region) # distribuição regional bem menor\nplot(Defensivos~Region)# os valores nacionais são puxados por um valor extremo\nplot(Ca~Region) # distribuição regional bem menor\nplot(P~Region) # Distribuição regional bem menor, médias de diferenciam \nplot(kg_CO2_Eq~Region) # se distribuem de forma parecida, entretanto há falta de dados \nplot(semente~Region) # grande incerteza nos dados nacionais\nplot(K~Region) # dados regionais com incerteza mínima, nacionais com incerteza normal.\nplot(N~Region) # não há grandes diferenças\n\n# 4.3 plots entre variáveis\nplot(Produtividade~Ca)\nplot(Produtividade~K)\nplot(produtividade~ano)\n\nxyplot(Produtividade~Ca|Region)\nxyplot(Produtividade~kg_CO2_Eq|Region)\nxyplot(Produtividade~K|Region)\nxyplot(Produtividade~Ano|Region)\nxyplot(Produtividade~N|Region)\nxyplot(Produtividade~semente|Region)\nxyplot(Produtividade~P|Region)\nxyplot(Produtividade~Defensivos|Region)\n\nregCA <-subset(soja,Region==\"Regional\")\nlmod1 <- lm(Produtividade~Ca,data=regCA)\nsummary(lmod1)\n\nlmod2 <-lm(Produtividade~K,data=regCA)\nsummary(lmod2)\n\nlmod3 <-lm(Produtividade~P,data = regCA)\nsummary(lmod3)\n# 4.4 PCA\npca1 <-prcomp(soja[,3:11],scale=T)\nsummary(pca1)\nloadings(pca1)\nbiplot(pca1) \n# 4.5 FA\nFA1 <-factanal(soy[,3:11],factors=3,rotation=\"varimax\")\nsummary(FA1)\n\n# 4.6 Análise de média e desvio padrão\n\naggregate(Produtividade,by=list(Region),FUN=mean)\naggregate(Produtividade,by=list(Region),FUN=sd)\n\naggregate(N,by=list(Region),FUN=mean)\naggregate(N,by=list(Region),FUN=sd)\nCV(mean=mean(Produtividade),sd=sd(Produtividade))\naggregate()\nCV(mean=mean(N),sd=sd(N)) \nCV(mean=0.052,sd=0.0113)\n\n# 5 Modelos ANOVA\n#5.1 modelos para descarte do ano \n\nfit0 <-lm(Produtividade~Ano)\nsummary(fit0)\nanova(fit0)\n\n#5.2 modelos de anova para grupo \n\nfit1 <-aov(Produtividade~Region)\nsummary(fit1)\n \n\nfit2<-aov(K~Region)\nsummary(fit2)\n\nfit3 <-aov(N~Region)\nsummary(fit3)\n\n\nfit4 <-aov(Diesel~Region)\nsummary(fit4)\n\n\nfit5 <-aov(P~Region)\nsummary(fit5)\n\nfit6 <-aov(Ca~Region)\nsummary(fit6)\n\n\nfit7 <-aov(Defensivos~Region)\nsummary(fit7)\n\nfit8 <-aov(kg_CO2_Eq~Region)\nsummary(fit8)\n\n# 5.3 Análise de diferenças entre grupos com TukeyHSD \n\nTukeyHSD(fit1) \nTukeyHSD(fit2) \nTukeyHSD(fit3)\nTukeyHSD(fit4) \nTukeyHSD(fit5) \nTukeyHSD(fit6) \nTukeyHSD(fit7) \nTukeyHSD(fit8)\nTukeyHSD(fit9) \nplot(TukeyHSD(fit1)) \nplot(TukeyHSD(fit2)) \nplot(TukeyHSD(fit3)) \nplot(TukeyHSD(fit4)) \nplot(TukeyHSD(fit5)) \nplot(TukeyHSD(fit6)) \nplot(TukeyHSD(fit7)) \nplot(TukeyHSD(fit8))\n\n\n# 6. Criação de novoa grupos \n\n# 6.1 anáise de cluster \nber <-rownames(soja)\nhc <-hclust(dist(mat001),method=\"single\")\nplot(hc,hang = -1,labels = ber)\n\n# produção de grupos \n\n\ngrupos <- c(\n\n\n# 7.Análises nos grupos\n# 7.1 annálise exploratória \n# plots bivariados \n \nplot(Produtividade~grupos)\nplot(Defensivos~grupos)\nplot(Ca~grupos)\nplot(P~grupos)\nplot(kg_CO2_Eq~grupos)\nplot(semente~grupos) \nplot(K~grupos)\nplot(N~grupos)\n\n# Modelos para dados primários e secundários\n\nplot(Ca~dataty)\nplot(K~dataty)\nplot(P~dataty)\nplot(N~dataty)\nplot(semente~dataty)\nplot(Diesel~dataty)\n# 7.2 ANOVA para grupos\n\nfit1b <-aov(Produtividade~grupos)\nsummary(fit1)\n \n\nfit2b <-aov(Defensivos~grupos)\nsummary(fit2)\n\nfit3b <-aov(N~grupos)\nsummary(fit3)\n\n\nfit4b <-aov(Diesel~grupos)\nsummary(fit4)\n\n\nfit5b <-aov(P~grupos)\nsummary(fit5)\n\nfit6b <-aov(Ca~grupos)\nsummary(fit6)\n\n\nfit7b <-aov(Defensivos~grupos)\nsummary(fit7)\n\nfit8b <-aov(kg_CO2_Eq~grupos)\nsummary(fit8)\n\n# 7.3 Análise de diferenças entre grupos com TukeyHSD \n\nTukeyHSD(fit1b) \n\nTukeyHSD(fit2b) \nTukeyHSD(fit3b)\nTukeyHSD(fit4b) \nTukeyHSD(fit5b) \nTukeyHSD(fit6b) \nTukeyHSD(fit7b) \nTukeyHSD(fit8b)\n\nplot(TukeyHSD(fit1b)) \nplot(TukeyHSD(fit2b)) \nplot(TukeyHSD(fit3b)) \nplot(TukeyHSD(fit4b)) \nplot(TukeyHSD(fit5b)) \nplot(TukeyHSD(fit6b)) \nplot(TukeyHSD(fit7b)) \nplot(TukeyHSD(fit8b))\n\n",
    "created" : 1453917422388.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "612167359",
    "id" : "2D4B4F4A",
    "lastKnownWriteTime" : 1454002225,
    "path" : "~/r/soy/soy.R",
    "project_path" : "soy.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}